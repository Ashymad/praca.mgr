\documentclass[pl,12pt]{aghdpl}
% \documentclass[en,11pt]{aghdpl}  % praca w języku angielskim

% Lista wszystkich języków stanowiących języki pozycji bibliograficznych użytych w pracy.
% (Zgodnie z zasadami tworzenia bibliografii każda pozycja powinna zostać utworzona zgodnie z zasadami języka, w którym dana publikacja została napisana.)
\usepackage[english,polish]{babel}

% Użyj polskiego łamania wyrazów (zamiast domyślnego angielskiego).
\usepackage{polski}

\usepackage[utf8]{inputenc}

% Załączniki

\usepackage[toc, page]{appendix}
\renewcommand\appendixpagename{Załączniki}
\renewcommand\appendixtocname{Załączniki}

% dodatkowe pakiety

\usepackage{mathtools}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{float}% do umieszczenia floatów [H]
\usepackage{enumitem}
\setlist{nosep} % or \setlist{noitemsep} to leave space around whole list
\usepackage[bookmarks,hidelinks]{hyperref}

\usepackage{import}
\usepackage{bm}
\usepackage{pgfplots}
\pgfplotsset{compat=1.16}
\usepackage{tikzscale}
\usepgfplotslibrary{external}
\tikzexternalize

\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
% Środowisko float do kodu źródłowego \begin{program}

\floatstyle{plaintop}
\ifcsname{chapter}\endcsname%
    \newfloat{program}{!tbh}{lop}[chapter]
\else%
    \newfloat{program}{!tbh}{lop}
\fi
\floatname{program}{Kod źr.}

% Kod poniżej powoduje, że floaty nie wylatują poza granice sekcji

\usepackage{placeins}

\ifcsname{chapter}\endcsname%
    \let\Oldchapter\chapter%
    \renewcommand{\chapter}{\FloatBarrier\Oldchapter}
\fi

\let\Oldsection\section%
\renewcommand{\section}{\FloatBarrier\Oldsection}

\let\Oldsubsection\subsection%
\renewcommand{\subsection}{\FloatBarrier\Oldsubsection}

\let\Oldsubsubsection\subsubsection%
\renewcommand{\subsubsection}{\FloatBarrier\Oldsubsubsection}

% --- < bibliografia > ---


\usepackage[
style=numeric,
sorting=none,
%
% Zastosuj styl wpisu bibliograficznego właściwy językowi publikacji.
language=autobib,
autolang=other,
% Zapisuj datę dostępu do strony WWW w formacie RRRR-MM-DD.
urldate=iso,
seconds=true,
% Nie dodawaj numerów stron, na których występuje cytowanie.
backref=false,
% Podawaj ISBN.
isbn=true,
% Nie podawaj URL-i, o ile nie jest to konieczne.
url=false,
%
% Ustawienia związane z polskimi normami dla bibliografii.
maxbibnames=3,
% Jeżeli używamy Bibera:
backend=biber
]{biblatex}

\usepackage{csquotes}
% Ponieważ `csquotes` nie posiada polskiego stylu, można skorzystać z mocno zbliżonego stylu chorwackiego.
\DeclareQuoteAlias{croatian}{polish}

\addbibresource{bibliografia.bib}

% Przecinki zamiast kropek do oddzielenia pól wpisu bibliograficznego
% i dwukropek po nazwisku autora, bez kropki na końcu
\AtBeginBibliography{
    \renewcommand\labelnamepunct{:\space}
    \renewcommand\newunitpunct{\addcomma\space}
    \renewcommand{\finentrypunct}{}
    \renewcommand{\bibopenparen}{\addcomma\addspace}
    \renewcommand{\bibcloseparen}{\addspace}
}

% Nie wyświetlaj wybranych pól.
%\AtEveryBibitem{\clearfield{note}}


% ------------------------
% --- < listingi > ---

% Użyj czcionki kroju Times.
\usepackage{newtxtext}
\usepackage{newtxmath}

\usepackage{listings}
\usepackage{jlcode}
\lstset{language=Julia}

\lstset{%
        literate={ą}{{\k{a}}}1
           {ć}{{\'c}}1
           {ę}{{\k{e}}}1
           {ó}{{\'o}}1
           {ń}{{\'n}}1
           {ł}{{\l{}}}1
           {ś}{{\'s}}1
           {ź}{{\'z}}1
           {ż}{{\.z}}1
           {Ą}{{\k{A}}}1
           {Ć}{{\'C}}1
           {Ę}{{\k{E}}}1
           {Ó}{{\'O}}1
           {Ń}{{\'N}}1
           {Ł}{{\L{}}}1
           {Ś}{{\'S}}1
           {Ź}{{\'Z}}1
           {Ż}{{\.Z}}1
}

% Ustawienia pakietu lstlisting do umieszczania kodu

\usepackage{color}

\definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mygray}{rgb}{0.5,0.5,0.5}
\definecolor{mymauve}{rgb}{0.58,0,0.82}

\lstset{%
  backgroundcolor=\color{white},     % choose the background color
  basicstyle=\ttfamily\footnotesize, % size of fonts used for the code
  breaklines, breakatwhitespace,     % automatic line breaking only at whitespace
  commentstyle=\color{mygreen},      % comment style
  numbers=left,
  showstringspaces=false,
  numberstyle=\tiny,
  frame=l,
  escapeinside={*@}{@*},           % if you want to add LaTeX within your code
  keywordstyle=\color{blue},         % keyword style
  stringstyle=\color{mymauve}        % string literal style
}

% ------------------------

\AtBeginDocument{%
        \renewcommand{\tablename}{Tab.}
        \renewcommand{\figurename}{Rys.}
}

% ------------------------
% --- < tabele > ---

\usepackage{array}
\usepackage{tabularx}
\usepackage{multirow}
\usepackage{booktabs}
\usepackage{makecell}
\usepackage[flushleft]{threeparttable}

% defines the X column to use m (\parbox[c]) instead of p (`parbox[t]`)
\newcolumntype{C}[1]{>{\hsize=#1\hsize\centering\arraybackslash}X}


%---------------------------------------------------------------------------

\author{Szymon Piotr Mikulicz}

\makeatletter% Poniższe makra są wyłącznie zdefiniowane w klasie aghdpl-imir
\@ifclassloaded{aghdpl}{%

  \sex{m} % Mężczyzna - m; kobieta - cokolwiek
  \shortauthor{S.\ Mikulicz}
  \albumnum{279253}
  \address{Legionów 49, 05-220 Zielonka}

  \titlePL{Wykorzystanie uczenia maszynowego do identyfikacji metody kompresji
  sygnału akustycznego}
  \titleEN{{The use of machine learning to identify the method of acoustic
  signal compression}}

  \shorttitlePL{Identyfikacja kompresji audio} % skrócona wersja tytułu
  \shorttitleEN{Identification of audio compression}

  % rodzaj pracy bez końcówki fleksyjnej np. inżyniersk, magistersk
  \thesistypePL{magistersk}
  \thesistypeEN{master's}

  \supervisor{dr hab. inż. Bartłomiej Borkowski}

  \reviewer{prof. dr hab. inż. Jerzy Wiciak}

  \degreeprogrammePL{Inżynieria Akustyczna}
  \degreeprogrammeEN{Acoustic Engineering}

  \specialisationPL{Drgania i Hałas w Technice i Środowisku}
  \specialisationEN{Vibration and Noise in Technology and Environment}

  \graduationyear{2019}
  \years{2018/2019}
  \yearofstudy{II}
  \formPL{stacjonarne}
  \formEN{full-time}

  % zgoda na publikację pracy w internecie: t-zgoda, cokolwiek 
  % innego-brak zgody
  \agree{t}

  % praktyka (dyplomowa)
  \apprenticeship{Katedra Mechaniki i Wibroakustyki}

  \department{Department of Mechanics and Vibroacoustics}

  \facultyPL{Wydział Inżynierii Mechanicznej i Robotyki}
  \facultyEN{Faculty of Mechanical Engineering and Robotics}

  \thesisplan{% Przykładowy plan pracy, należy omówić z promotorem
    \begin{enumerate}
    \item Omówienie tematu pracy i sposobu realizacji z promotorem.
    \item Zebranie i opracowanie literatury dotyczącej tematu pracy.
    \item Zebranie i opracowanie wyników badań.
    \item Analiza wyników badań, ich omówienie i zatwierdzenie przez promotora.
    \item Opracowanie redakcyjne.
    \end{enumerate}
  }

  \summaryPL{\indent\indent%
	  {[Treść streszczenia]}
  }
  \summaryEN{\indent\indent%
	  {[Summary text]}
  }

  \acknowledgements{%
    Dziękuję mojemu promotorowi, prof.~Borkowskiemu, za cierpliwość, Stevenowi
    G.  Johnsonowi za MDCT.jl, Donaldowi E. Knuthowi za \TeX\ oraz moim
    przyjaciołom ot tak, bo mogę.
  }

  \setlength{\cftsecnumwidth}{10mm}
}{}%
\makeatother%

\date{\today}

%---------------------------------------------------------------------------
\setcounter{secnumdepth}{4}
\brokenpenalty=10000\relax

\begin{document}

\titlepages{}

% Ponowne zdefiniowanie stylu `plain`, aby usunąć numer strony z pierwszej strony spisu treści i poszczególnych rozdziałów.
\fancypagestyle{plain}
{%
        % Usuń nagłówek i stopkę
        \fancyhf{}
        % Usuń linie.
        \renewcommand{\headrulewidth}{0pt}
        \renewcommand{\footrulewidth}{0pt}
}

\setcounter{tocdepth}{2}
{\singlespacing\tableofcontents}
\clearpage

\chapter{Wprowadzenie}
\section{Cel pracy}
\section{Zawartość pracy}
\chapter{Kompresja audio}
\section{Wprowadzenie}
W informatyce pojęcie kompresji odnosi się do procesu zmniejszenia rozmiaru
pliku. Jako że pliki multimedialne typu filmy i muzyka są dużej wielkości
{\color{red}jakiej, porównać!} bez użycia kompresji w porównaniu do innego typu
plików wykorzystywanych przez użytkowników komputera, a ponadto przesyłane są
często one przez łącze sieciowe do odbiorcy, zmniejszenie ich rozmiaru
oszczędza ogromne ilości miejsca na dysku {\color{red}jakie ilości} jak i
przepustowości sieci. Z tego powodu kompresja audio, video i obrazów jest
stosowana powszechnie, nieskompresowane pliki multimedialne używane są
wyłącznie gdy wymagany jest szybki dostęp do ich fragmentów i brak obaw o
pogorszenie jakości, na przykład podczas procesu ich edycji.

Ponadto, gdyż rodzaj kompresji stosowany do innych plików, np.\ tekstowych,
czyli kompresja bezstratna nie osiąga wystarczającego zmniejszenia rozmiaru
plików multimedialnych, z powodu wysokiej entropii tego rodzaju plików, stosuje
się metody pozwalające na dalsze zmniejszenie rozmiaru kosztem utraty
możliwości odtworzenie oryginalnego sygnału po dekompresji -- z tego powodu ten
typ kompresji nazywa się kompresją stratną.

{\color{red}może wykres z rozmiarami plików po kompresji}
\section{Kompresja bezstratna}

W procesie kompresji stratnej uzyskuje się zmniejszenie rozmiaru pliku bez
utraty informacji. Uzyskuje się to poprzez zastosowanie pewnych przekształceń
które zostaną tu wytłumaczone na przykładzie kompresji FLAC
(eng. \textit{Free Lossless Audio Codec}), z dwóch powodów: FLAC jest obecnie
najpopularniejszym formatem kompresji bezstratnej oraz posiada w pełni otwartą
specyfikację i referencyjny enkoder.

\begin{figure}[!tbh]
  \centering
  \import{./vecgraphics/}{FLAC-scheme.pdf_tex}
  \caption{Schemat kompresji bezstratnej (na przykładzie FLAC)}
  \label{fig:FLAC_scheme}
\end{figure}

Podczas procesu kompresji FLAC występują cztery główne kroki (patrz rys.
\ref{fig:FLAC_scheme}): fragmentacja, dekorelacja, modelowanie i kodowanie.
Pierwszy krok, czyli fragmentacja dzieli sygnał cyfrowy na fragmenty (eng.
\textit{blocks}), których długość wybierana jest na tyle krótka by model
stworzony w trzecim kroku był jak najbardziej efektywny i na tyle długa by
nadmiarowość (eng. \textit{overhead}) wynikająca z konieczności zapisu
parametrów zastosowanych do kompresji fragmentu była jak najmniejsza. 

W drugim kroku przeprowadzana jest dekorelacja kanałów w pliku audio, w
przypadku pliku stereofonicznego kanały prawy $r$ i lewy $l$ zamieniane są na środkowy
$m = \frac{l + r}{2}$ i boczny $s = l - r$. Pozwala to znacznie zwiększyć
poziom kompresji w dalszych krokach, ponieważ typowo duża korelacja pomiędzy
kanałami powoduje że kanał różnicowy (boczny) zawiera niewielkie wartości
amplitudy próbek.

Trzeci krok jest najbardziej istotny gdyż w nim tworzony jest model
matematyczny w taki sposób, by różnica pomiędzy sygnałem wygenerowanym przez
niego a sygnałem rzeczywistym (nazywana błędem lub residuum), wymagała
jak najmniejszej liczby bitów na próbkę (eng. \textit{bits-per-sample}).
Standard FLAC przewiduje dwa typy modeli: wielomian lub kodowanie predykcyjne
LPC (eng. \textit{Linear Predictive Coding}). Dopasowanie wielomianu wymaga
mniejszej mocy obliczeniowej lecz wynik jest mniej dokładny niż LPC.

Ostatni krok to kodowanie entropijne uzyskanego w poprzednim kroku sygnału
błędu. W kompresji FLAC wykorzystane jest kodowanie Huffmana, które
wykorzystuje nierównomierności rozkładu częstotliwości występowania sekwencji
bitów w danych, zapisując najczęściej występujące sekwencję mniejszą liczbą
bitów. Zazwyczaj związane jest to z zapisem tzw.\ słownika, który
przyporządkowuje sekwencje bitów do kodów Huffmana. Natomiast, ponieważ dane
błędu uzyskane w tym procesie posiadają rozkład Laplace'a (podwójnie
wykładniczy), możliwe jest zastosowanie szczególnego układu kodów Huffmana,
nazwanych kodami Rice'a. Własnością tych kodów jest możliwość ich wygenerowania
na podstawie pojedynczego parametru opisującego rozkład danych (parametru
Rice'a), ponadto standard FLAC pozwala na podzielenie fragmentu na części,
gdzie każda część posiada inny parametr Rice'a, co pozwala na lepsze
dopasowanie go do zmienności rozkładu w trakcie trwania sygnału.

Poprawnie działający enkoder i dekoder pozwolą otrzymać, po kompresji i
dekompresji pliku, plik w którym próbki sygnału audio będą takie same jak w
pliku oryginalnym. Z tego powodu wykrycie czy plik został poddany takiemu
procesowi niemożliwe na podstawie samego sygnału audio.

\section{Kompresja stratna}

Celem kompresji stratnej, w przeciwieństwie do bezstratnej nie jest stworzenie
mniejszego pliku który po dekompresji odtworzy sygnał wejściowy co do próbki, lecz
stworzenie pliku dużo mniejszego, który po dekompresji i odtworzeniu będzie
możliwie nierozróżnialny od oryginalnego dla większości słuchaczy. Dlatego też
ten typ kompresji jest dużo bardziej skomplikowany gdyż wykorzystuje nie tylko
te techniki co kompresja bezstratna, ale również wymaga zastosowania wiedzy
z dziedziny psychoakustyki. W związku z tym przetestowanie działania kodeku
wymaga testów odsłuchowych co znacząco spowalnia proces tworzenia nowych
rozwiązań.

\begin{figure}[!tbh]
  \centering
  \import{./vecgraphics/}{PAC-scheme.pdf_tex}
  \caption{Schemat kompresji stratnej}
  \label{fig:PAC_scheme}
\end{figure}

Na rysunku \ref{fig:PAC_scheme} przedstawiony jest uproszczony schemat typowego
enkodera PAC (eng. \textit{Perceptual Audio Coding}) wykorzystywanego w
kompresji stratnej. Posiada on cztery główne elementy: transformację
analizującą, kwantyzator, enkoder i model psychoakustyczny.

Pierwszym elementem jest transformacja analizująca, która zamienia sygnał audio
na postać którą może wykorzystać kwantyzator wraz z modelem psychakustycznym.
Każdy z opisanych w tym rozdziale kodeków wykorzystuje w tym celu miedzy innymi
zmodyfikowaną transformację kosinusową MDCT (eng. \textit{Modified Discrete
Cosine Transform}) określoną wzorem:
\begin{equation}
  X_k = \sum_{n=0}^{2N-1}x_n\cos\left[\frac{\pi}{N}
  \left(n+\frac{1}{2}+\frac{N}{2}\right)\left(k+\frac{1}{2}\right)\right].
\end{equation}
Jest to funkcja liniowa $F\colon \bm{R}^{2N} \to \bm{R}^N$, która przekształca
$2N$ liczb rzeczywistych $x_0, \dotsc, x_{2N+1}$ w $N$ liczb rzeczywistych
$x_0, \dotsc, x_{N+1}$. Posiada ona szczególną właściwość wykorzystywaną w
procesie kompresji, mianowicie większość współczynników z niej uzyskanych
posiada wartości bliskie zeru.

Aby przeprowadzić transformację na sygnale, wybierana jest długość okna $l =
2c$, gdzie $c \in \bm N$, oraz skok $h \in \bm N$. Długość okna określa długość
fragmentu sygnału $\bm s$ który zostanie pomnożony przez okno $\bm w$, a
następnie poddany transformacji, natomiast skok określa co ile próbek jest
wycinany kolejny fragment. Wynikiem całej operacji jest jest macierz $\bm X =
\begin{bmatrix}\bm x_1 & \bm x_2 & \cdots  & \bm x_k\end{bmatrix}$, stworzona z
wektorów \[\bm x_n = \text{MDCT}\left\{\bm
w\begin{bmatrix}s_{(n-1)h}\\\vdots\\s_{(n-1)h+l}\end{bmatrix}\right\},\] gdzie
okno $\bm w$ jest wektorem o długości $l$, wyznaczonym na podstawie pewnej
funkcji $w(n)$, której zadaniem jest zniwelowanie efektów brzegowych. Aby
transformacja była odwracalna, okno musi być symetryczne, tzn.\ spełniać
warunek symetryczności (\ref{eq:symm_cond}) i warunek Princena-Bradleya
(\ref{eq:p-b_cond}).
\begin{equation}\label{eq:symm_cond}
  w_n = w_{l-1-n}
\end{equation}
\begin{equation}\label{eq:p-b_cond}
  w_n^2+w_{n+\frac{l}{2}}^2 = 1
\end{equation}

Sygnał audio jest także przetwarzany przez model psychakustyczny którego
zadaniem jest przewidywanie zachowania ucha ludzkiego, w taki sposób by
określić czego potencjalny słuchacz może nie usłyszeć, a co usłyszy.
Wykorzystuje on w tym celu wiedzę o konstrukcji ucha oraz wiedzę uzyskaną
poprzez przeprowadzanie testów odsłuchowych.

Informacje uzyskane z modelu psychoakustycznego są następnie stosowanie przez
kwantyzator do kwantyzacji (ograniczenia zbioru wartości) wyniku transformacji
analizującej. Elementy które model uzna za niesłyszalne dla potencjalnego
odbiorcy zostaną silniej skwantyzowane niż te które zostaną uznane za
słyszalne. Jest to proces nieodwracalny z którego wynika ,,stratność'' tego
rodzaju kompresji, w jego wyniku dostaje się także macierz wag przez którą
trzeba pomnożyć uzyskane wartości w procesie odwrotnym.

W ostatnim kroku, podobnie jak w przypadku kompresji bezstratnej, dane uzyskane
z poprzedniego kroku są zakodowane przy użyciu kodowania entropijnego. Jest ono
bardzo skuteczne na uzyskanych danych dzięki opisanej wcześniej własności
transformaty MDCT oraz procesowi kwantyzacji, które powodują wyzerowanie się
dużej liczby współczynników uzyskanych w procesie transformacji.

\begin{figure}[!tbh]
  \centering
  \import{./vecgraphics/}{IPAC-scheme.pdf_tex}
  \caption{Schemat dekompresji stratnej}
  \label{fig:IPAC_scheme}
\end{figure}

Aby z pliku skompresowanego uzyskać sygnał audio stosuje się dekompresją (patrz
rys. \ref{fig:IPAC_scheme}), gdzie kolejno następuje: dekodowanie zakodowanych
entropijnie danych, odwrotna kwantyzacja która polega na wymnożeniu danych
przez odpowiednie wagi (ten proces jednakże nie odtwarza w pełni danych z przed
kwantyzacji lecz dane zbliżone) oraz synteza, czyli zastosowanie odwrotnych
transformat analizujących, w przypadku MDCT będzie to IMDCT (eng.
\textit{Inverse Modified Discrete Cosine Transform})

W kolejnych punktach zostaną dokładniej opisane elementy procesu kompresji
wykorzystane w pięciu popularnych kodekach.

\subsection{MP3}
Format MP3 (eng. \textit{MPEG-1 Layer 3}) został zdefiniowany w roku 1991 jako część
standardu MPEG-1 (eng. \textit{Moving Picture Experts Group Phase 1}) a
następnie rozszerzony w standardach MPEG-2 oraz MPEG-2.5. Jest to obecnie
nadal jeden z najbardziej popularnych formatów, choć od czasu jego wprowadzenia
powstały kodeki o dużo lepszych parametrach.

W tym kodeku oprócz MDCT do analizy sygnału jest zastosowany również bank
filtrów PQMF (eng. \textit{Pseudo Quadrature Mirror Filter}), jest to bank filtrów
o prawie idealnej rekonstrukcji, którego proces konstrukcji wygląda
następująca:
\begin{enumerate}
  \item Projekt prototypowego filtra dolnoprzepustowego $h(n)$ o długości $M =
    LN$, gdzie $L, M, N \in \bm Z$
  \item Filtr musi anulować aliasing w sąsiadujących podpasmach: \[
      \begin{array}{rl}
        |H(e^{i\omega})|^2 + H(e^{i\frac{\pi}{N}-\omega})|^2 = 2, &
        \quad0<|\omega|<\frac{\pi}{2N} \\
        |H(e^{i\omega})|^2 = 0, & \quad|\omega| > \frac{\pi}{N}
      \end{array}\]
  \item Filtry analizy $h_k(n)$ to modulacje kosinusowe filtra $h(n)$:\[
      h_k(n) = h(n)\cos\left[\left(k+\frac{1}{2}\right)
      \left(n-\frac{M-1}{2}\right)\frac{\pi}{N}+\phi_k\right],\]
      gdzie $k = 0,\dotsc,N-1$, a faza spełnia warunek:\[
      \phi_{k+1}-\phi_k = (2r+1)\frac{\pi}{2}.\]
  \item Bank filtrów jest ortogonalny, więc filtry syntezy są filtrami analizy
    odwróconymi w czasie:\[
      f_k(n) = h_k(M-1-n)\]
\end{enumerate}
W formatach od MPEG-1 Layer I do MPEG-1 Layer III, ten bank filtrów użyto z $N = 32$
pasmami i o $M = 512$ współczynnikach, przy czym w MP3 dodatkowo do wyjścia każdego z
pasm zaaplikowano filtr Princena-Bradleya {\color{red}odnośnik}.

MDCT w tym formacie wykorzystuje okno sinusowe (nazywane też kosinusowym) (rys.
\ref{fig:win_MP3}) o długości $N$, o następującym wzorze:
\begin{equation}\label{eq:sine_win}
  w(n) = \sin\left(\frac{\pi n}{N}\right) = \cos\left(\frac{\pi n}{N} - \frac{\pi}{2}\right).
\end{equation}

\begin{figure}[!tbh]
  \centering
  \includegraphics[width=0.5\textwidth]{plots/win_MP3.pgf}
  \caption{Okno sinusowe/kosinusowe}
  \label{fig:win_MP3}
\end{figure}

\subsection{AAC}

MDCT w tym formacie wykorzystuje okno KBD (eng.
\textit{Keiser-Bessel-derived}), jest to okno pochodne okna Keisera, stworzone
by spełniało warunki zastosowania w MDCT (\ref{eq:symm_cond},
\ref{eq:p-b_cond}). Okno Kaisera ma wzór:
\begin{equation}\label{eq:kaiser_win}
  w_k(n) = \frac{I_0\left[\pi\alpha\sqrt{1-\left(\frac{2n}{N}-1\right)^2}\right]}
  {I_0(\pi\alpha)},\quad 0 \leq n \leq N,
\end{equation}
gdzie długość okna wynosi $N+1$, $I_0$ to zerowego rzędu zmodyfikowana funkcja
Bessela pierwszego rodzaju, a $\alpha$ to parametr wpływający na kształt tego
okna. Na jego podstawie zdefiniowane jest okno Kaisera-Bessela o długości $2N$
o wzorze:
\begin{equation}\label{eq:kbd_win}
  w(n) = \begin{cases}
    \sqrt{\frac{\sum_{i=0}^{n}w_k(i)}{\sum_{i=0}{N}w_k(i)}} & \text{dla }0 \leq n \leq N \\
    \sqrt{\frac{\sum_{i=0}^{2N-1-n}w_k(i)}{\sum_{i=0}{N}w_k(i)}} & \text{dla }N \leq n \leq 2N-1 \\
    0 & \text{w innym przypadku}
  \end{cases}.
\end{equation}
AAC wykorzystuje okno KBD z parametrem $\alpha = 4$ (rys. \ref{fig:win_AAC})

\begin{figure}[!tbh]
  \centering
  \includegraphics[width=0.5\textwidth]{plots/win_AAC.pgf}
  \caption{Okno KBD, $\alpha = 4$}
  \label{fig:win_AAC}
\end{figure}

\subsection{Ogg Vorbis}

MDCT w tym formacie wykorzystuje okno zboczowe (eng. \textit{slope}) (rys.
\ref{fig:win_OGG}) o długości $N$, o wzorze:
\begin{equation}\label{eq:slope_win}
  w(n) = \sin\left(\frac{\pi}{2}\sin^2\left(\frac{\left(n +
  \frac{1}{2}\right)}{N\pi}\right)\right)
\end{equation}
\begin{figure}[!tbh]
  \centering
  \includegraphics[width=0.5\textwidth]{plots/win_OGG.pgf}
  \caption{Okno zboczowe}
  \label{fig:win_OGG}
\end{figure}

\subsection{AC-3}

MDCT w tym formacie wykorzystuje okno KBD (\ref{eq:kaiser_win},
\ref{eq:kbd_win}), z parametrem $\alpha = 5$ (rys. \ref{fig:win_AC3}).
\begin{figure}[!tbh]
  \centering
  \includegraphics[width=0.5\textwidth]{plots/win_AC3.pgf}
  \caption{Okno KBD, $\alpha = 5$}
  \label{fig:win_AC3}
\end{figure}

\subsection{WMA}

MDCT w tym formacie wykorzystuje okno sinusowe (\ref{eq:sine_win})
(rys. \ref{fig:win_MP3})

\chapter{Realizacja}
Aby stworzyć proces pozwalający na wykrycie formatu z którego sygnał audio
został dekodowany, przeanalizowano dwa podejścia, nie tylko wykorzystano
techniki uczenia maszynowego, ale ponadto, zaimplementowano algorytm który, w
przeciwieństwie do modelu, nie wymaga uprzedniego treningu.
\section{Podejście algorytmiczne}
Implementowany algorytm oparty został o algorytm opisany w
{\color{red}odnośnik}. Algorytm ten potrafi wskazać czy dany sygnał został
skompresowany przez pewien kodek audio, którego parametry: transformacja
analizująca $T(x)$, długość okna $N \in \bm N_+$, funkcja okna $w(n)$ oraz skok
$h \in \left[1, N\right]$ są znane.
Przedstawia się on następująco:
\begin{enumerate}
  \item Wycięcie $\frac{N}{2}+1$ fragmentów o długości $L$ z sygnału $\bm s$,
    poczynając od indeksu $i$ do indeksu $i+\frac{N}{2}$
    \begin{equation}
      \begin{bmatrix}
        s_i \\\vdots\\ s_{i+L-1}
      \end{bmatrix},
      \begin{bmatrix}
        s_{i+1} \\\vdots\\ s_{i+L}
      \end{bmatrix}, \dotsc,
      \begin{bmatrix}
        s_{i+\frac{N}{2}} \\\vdots\\ s_{i+\frac{N}{2}+L-1}
      \end{bmatrix}
    \end{equation}
  \item Wykonanie krótkoczasowej transformacji $T(x)$ z oknem $w(n)$ o długości
    $N$ i skoku $h$ na fragmentach uzyskanych w poprzednim kroku uzyskując
    $\frac{N}{2}+1$ macierzy $\hat{\bm S}_i$
    \begin{equation}
      \hat{\bm S}_i = \underset{w(n), N, h}{T}\left(
        \begin{bmatrix}
          s_i \\\vdots\\ s_{i+L-1}
        \end{bmatrix}\right)
    \end{equation}
  \item Policzenie średniej modułów logarytmów dziesiętnych modułów macierzy
    $\hat{\bm S}_i$ uzyskując $\frac{N}{2}+1$ średnich $\left<\hat{\bm S}_i\right>$
    \begin{equation}
      \left<\hat{\bm S}_i\right> =
      \frac{1}{L}\sum_m\sum_n\left|\log_{10}
      \left(\left|\hat{S}_{i, mn}\right|\right)\right|
    \end{equation}
  \item Wyznaczenie modułów różnic pomiędzy kolejnymi średnimi uzyskując
    wektor $\bm d_i$ o długości $\frac{N}{2}$
    \begin{equation}
      \bm d_i = \begin{bmatrix}
        \left|\left<\hat{\bm S}_i\right> -
        \left<\hat{\bm S}_{i+1}\right>\right|\\
        \left|\left<\hat{\bm S}_{i+1}\right> -
        \left<\hat{\bm S}_{i+2}\right>\right|\\
        \vdots\\
        \left|\left<\hat{\bm S}_{i+\frac{N}{2}-1}\right> -
        \left<\hat{\bm S}_{i+\frac{N}{2}}\right>\right|
      \end{bmatrix}
    \end{equation}
    \item Znalezienie wartości maksymalnej $d_{i,\max}$ wektora $\bm d_i$ oraz
      indeksu $k_{i,\max}$ który posiada ta wartość w tym wektorze
      \begin{equation}
        d_{i,\max} = \max_k\left\{d_{i, k}\right\}
      \end{equation}
      \begin{equation}
        k_{i,\max} = \argmax_k\left\{d_{i,k}\right\} \iff d_{i,\max} =
        d_{i,k_{i,\max}}
      \end{equation}
    \item Powtarzanie poprzednich kroków $M$ razy, zwiększając wartość $i$ o $L$
      w każdym kroku, tak że w $m$-tym kroku $i = i_0 + (m-1)L$, gdzie $i_0$ to
      dowolny wybrany indeks sygnału $\bm s$. Wynikiem operacji są wektory
      wartości maksymalnych $\bm d_{\max}$ i odpowiadających im indeksów $\bm
      k_{\max}$ o długości $M$
      \begin{equation}
        \bm d_{\max} = \begin{bmatrix}
          d_{i_0,\max}\\
          d_{i_0+L,\max}\\
          \vdots\\
          d_{i_0+(M-1)L,\max}
        \end{bmatrix},
        \bm k_{\max} = \begin{bmatrix}
          k_{i_0,\max}\\
          k_{i_0+L,\max}\\
          \vdots\\
          k_{i_0+(M-1)L,\max}
        \end{bmatrix}
      \end{equation}
    \item Znalezienie okresu $p_{\min}$, zdefiniowanego jako największa wartość
      $p \in [3, h]$ dla której współczynnik zmienności $V_{r}(p)$ reszt $r(p,
      j)$ z dzielenia elementów wektora indeksów wartości maksymalnych $\bm
      k_{\max}$ przez $p$ osiąga wartość minimalną
      \begin{equation}
        r(p, j) = k_{\max, j}\mod p
      \end{equation}
      \begin{equation}
        \overline r(p) = \frac{1}{M}\sum_{j=1}^{M}r(p, j)
      \end{equation}
      \begin{equation}
        V_{r}(p) = \frac{1}{\overline r(p)}\sqrt{\frac{1}{M}
        \sum_{j=1}^{M}\left(r(p, j) - \overline r(p)\right)^2}
      \end{equation}
      \begin{equation}
        p_{\min} = \max\left\{\argmin_{3 \leq p \leq h}
        \left\{V_{r}(p)\right\}\right\}
      \end{equation}
    \item Wyznaczenie wektora kątów $\bm\phi_k$ poprzez pomnożenie stosunku
      reszty z dzielenia elementów wektora $\bm k_{\max}$ przez
      okres $p_{\min}$ do $p_{\min}$ przez $2\pi$
      \begin{equation}
        \bm\phi_k = \frac{2\pi}{p_{\min}}\begin{bmatrix}
          k_{\max,1}\mod p_{\min}\\
          \vdots\\
          k_{\max,M}\mod p_{\min}\\
        \end{bmatrix}
      \end{equation}
    \item Obliczenie jednoliczbowego wskaźnika $C_{T(x),w(n),N,h}$ którego
      wielkość jest wprost proporcjonalna do prawdopodobieństwa zastosowania
      kompresji o parametrach $T(x)$, $w(n)$, $N$ i $h$. Jest
      on zdefiniowany jako odległość od środka układu średniej geometrycznej
      punktów określonych w układzie współrzędnych radialnych jako pary
      $(d_{\max, j}, \phi_{k, j})$, gdzie promieniami są elementy wektora
      wartości maksymalnych $\bm d_{\max}$, natomiast kątami są odpowiadające im
      elementy wektora kątów $\bm\phi_k$
      \begin{equation}
        C_{T(x),w(n),N,h} =\frac{1}{M}\sqrt{\left(\sum_{j=1}^{M}d_{\max,j}\sin
        \phi_{k,j}\right)^2+\left(\sum_{j=1}^{M}d_{\max,j}\cos
        \phi_{k,j}\right)^2}
      \end{equation}
\end{enumerate}
\subsection{Biblioteka \textit{IOLA.jl}}
Procedury algorytmu zaimplementowano w języku programowania \textit{Julia} w
postaci biblioteki o nazwie \textit{IOLA} (eng.\ \textit{Identification Of
Lossy Audio}).
\subsection{Średnia kwadratowa logarytmów}
\subsection{MDCT}
\subsection{Wykrywanie modulo}
\section{Uczenie maszynowe}
\subsection{Biblioteka Knet.jl}
\subsection{Konstrukcja modelu}
\subsection{Dane treningowe}
\chapter{Ewaluacja}
\section{Identyfikacja algorytmiczna}
\section{Identyfikacja modelem}
\subsection{Identyfikacja kompresji}
\subsection{Identyfikacja typu kompresji}
\subsection{Identyfikacja parametrów kompresji}
\subsection{Identyfikacja typu i parametrów kompresji}
\chapter{Podsumowanie}
\section{Wnioski końcowe}
\section{Dalsze kierunki badań}

%Kod poniżej dodaje Bibliografię do spisu treści
\cleardoublepage{}
\phantomsection{}
\addcontentsline{toc}{chapter}{Bibliografia}
\printbibliography{}

\end{document}
